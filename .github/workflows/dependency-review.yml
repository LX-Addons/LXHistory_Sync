name: ðŸ“¦ ä¾èµ–å®¡æ ¸

on:
  pull_request:
    types:
      - opened
      - synchronize

permissions:
  contents: read
  pull-requests: write

jobs:
  dependency-review:
    name: ä¾èµ–å˜æ›´å®¡æ ¸
    runs-on: ubuntu-latest
    if: ${{ github.actor == 'dependabot[bot]' }}
    steps:
      - name: ðŸ“¥ æ£€å‡ºä»£ç 
        uses: actions/checkout@v4
      
      - name: ðŸ” æ£€æŸ¥ä¾èµ–å˜æ›´
        uses: actions/dependency-review-action@v4
        with:
          fail-on-severity: moderate
      
      - name: ðŸ·ï¸ æ·»åŠ å®¡æ ¸æ ‡ç­¾
        run: |
          gh pr edit ${{ github.event.pull_request.number }} --add-label "éœ€è¦å®¡æ ¸"
          echo "âœ… å·²æ·»åŠ å®¡æ ¸æ ‡ç­¾"
        env:
          GH_TOKEN: ${{ secrets.GITHUB_TOKEN }}
      
      - name: ðŸ“Š ç”Ÿæˆä¾èµ–å˜æ›´æ‘˜è¦
        run: |
          echo "## ðŸ“¦ ä¾èµ–å˜æ›´æ‘˜è¦" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "æ­¤ PR ç”± Dependabot è‡ªåŠ¨åˆ›å»ºï¼ŒåŒ…å«ä¾èµ–æ›´æ–°ã€‚" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "âš ï¸ **è¯·ä»”ç»†å®¡æ ¸ä»¥ä¸‹å†…å®¹ï¼š**" >> $GITHUB_STEP_SUMMARY
          echo "- æ£€æŸ¥ä¾èµ–ç‰ˆæœ¬å˜æ›´æ˜¯å¦åˆç†" >> $GITHUB_STEP_SUMMARY
          echo "- ç¡®è®¤æ— å®‰å…¨æ¼æ´žå¼•å…¥" >> $GITHUB_STEP_SUMMARY
          echo "- éªŒè¯æž„å»ºå’Œæµ‹è¯•é€šè¿‡" >> $GITHUB_STEP_SUMMARY
