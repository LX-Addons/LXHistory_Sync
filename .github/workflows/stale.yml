name: 自动关闭不活跃 Issue 和 PR

on:
  schedule:
    - cron: "0 0 * * *"
  workflow_dispatch:

permissions:
  issues: write
  pull-requests: write

jobs:
  stale:
    name: 标记不活跃
    runs-on: ubuntu-latest
    timeout-minutes: 5
    steps:
      - name: 标记不活跃的 Issue 和 PR
        uses: actions/stale@b5d41d4e1d5dceea10e7104786b73624c18a190f  # v10.2.0
        with:
          days-before-stale: 30
          days-before-close: 7
          stale-issue-message: |
            此 Issue 已超过 30 天无任何活动。如果这是一个错误或您仍需要帮助，请添加新评论。否则，此 Issue 将在 7 天后自动关闭。
          stale-pr-message: |
            此 Pull Request 已超过 30 天无任何活动。如果您仍在处理此 PR，请添加新评论或推送新提交。否则，此 PR 将在 7 天后自动关闭。
          close-issue-message: |
            由于长时间无活动，此 Issue 已自动关闭。如果您认为这是错误的，请重新打开此 Issue 或创建一个新的 Issue。
          close-pr-message: |
            由于长时间无活动，此 Pull Request 已自动关闭。如果您想继续此工作，请重新打开此 PR 或创建一个新的 PR。
          stale-issue-label: "stale"
          stale-pr-label: "stale"
          exempt-issue-labels: "pinned,security,enhancement,待审核,dependencies"
          exempt-pr-labels: "pinned,security,enhancement,待审核,dependencies"
          exempt-draft-pr: true
          remove-stale-when-updated: true
          delete-branch: false
          operations-per-run: 100
